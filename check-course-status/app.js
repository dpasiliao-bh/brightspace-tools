const request = require("superagent");

require("dotenv").config();

const get_courses = async () => {
  const orgUnits = [
    8075, 8076, 8333, 8336, 8431, 8432, 8648, 8650, 8923, 8924, 9200, 9202,
    9347, 9348, 9419, 9420, 9587, 9588, 10861, 10863, 11057, 11060, 11132,
    11136, 11216, 11217, 11474, 11475, 11936, 12179, 12180, 12226, 12227, 12414,
    12784, 10869, 10871, 11619, 11624, 11944, 11945, 12168, 12169, 11041, 11043,
    11214, 11215, 11625, 11626, 11942, 11943, 12064, 12241, 12243, 12366, 12369,
    12422, 12572, 12573, 8067, 8068, 8244, 8246, 8341, 8344, 8421, 8422, 8697,
    8698, 8915, 8916, 9193, 9194, 9339, 9341, 9579, 9580, 11182, 11183, 11665,
    11666, 11697, 11698, 11950, 11951, 12041, 12042, 12220, 12221, 12411, 12441,
    12443, 8342, 8343, 9417, 9418, 11667, 11672, 12420, 8064, 8066, 8415, 8416,
    8691, 8692, 8913, 8914, 9187, 9188, 9335, 9338, 9577, 9578, 10864, 10868,
    11254, 11255, 11641, 11643, 11952, 11955, 12157, 12162, 10856, 10859, 11053,
    11055, 11209, 11521, 11522, 11699, 11704, 11933, 12171, 12172, 12228, 12230,
    12409, 8239, 8241, 10853, 10855, 11929, 8073, 8074, 8132, 8133, 8423, 8424,
    8682, 8700, 8793, 8794, 8921, 8922, 9195, 9196, 9345, 9346, 9585, 9586,
    10003, 10005, 10904, 10907, 12174, 12178, 12427, 12046, 12047, 12163, 12164,
    12417, 12445, 12446, 8429, 8430, 8643, 8645, 11532, 11535, 8059, 8061, 8359,
    8360, 8413, 8414, 8817, 8818, 8907, 8908, 9185, 9186, 9332, 9333, 9593,
    9594, 10096, 11129, 11131, 11642, 11648, 12236, 12238, 12449, 8176, 8177,
    8819, 8820, 9571, 9572, 9657, 9658, 10010, 10011, 10965, 10966, 12433,
    12435, 10949, 10950, 11184, 11185, 12413, 9457, 9458, 10872, 10874, 12502,
    12505, 11530, 11531, 12747, 12749, 8689, 8690, 12029, 12030, 8179, 8182,
    10012, 10013, 8218, 8223, 10020, 10021, 11005, 11019, 12438, 8135, 8138,
    10002, 10004, 11249, 11251, 8057, 8058, 8407, 8408, 8683, 8905, 8906, 9179,
    9180, 9327, 9330, 9569, 9570, 11524, 11527, 10911, 12430, 12421, 11938,
    11931, 8089, 11006, 12754, 12755, 10091, 8795, 8797, 12234, 12235, 8200,
    8203, 10018, 10019, 10990, 10124, 11935,
  ];

  const access_token = process.env.ACCESS_TOKEN;
  console.log({ access_token });
  let count = 0;
  for await (let course of orgUnits) {
    let api_endpoint =
      process.env.API_DOMAIN + `/d2l/api/lp/1.26/courses/${course}`;
    let response = await request
      .get(api_endpoint)
      .auth(access_token, { type: "bearer" });

    const info = response.body;

    if (info.IsActive) {
      console.log({ info });
      count++;
    }
  }
  console.log({ count });
};

get_courses();
